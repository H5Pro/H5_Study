<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>07canvas合成与裁剪</title>
    <style>
        canvas{
            background: #eee;
        }
    </style>
    <script>
        const draw = () => {
          // 1. 图像的合成
          const canvas0 = document.getElementById('compound')
          canvas0.height = 300
          const ctx0 = canvas0.getContext('2d')
          ctx0.save()
          ctx0.fillStyle = 'rgba(0, 0, 0, 0.5)'
          ctx0.fillRect(0, 0, 300, 300)
          ctx0.fillStyle = 'red'
          ctx0.fillRect(88, 88, 124, 124)
          ctx0.save()
          ctx0.translate(90, 90)
          ctx0.beginPath()
          ctx0.moveTo(2, 2)
          ctx0.lineTo(20, 2)
          ctx0.lineTo(20, 0)
          ctx0.lineTo(100, 0)
          ctx0.lineTo(100, 2)
          ctx0.lineTo(118, 2)
          ctx0.lineTo(118, 20)
          ctx0.lineTo(120, 20)
          ctx0.lineTo(120, 100)
          ctx0.lineTo(120, 100)
          ctx0.lineTo(118, 100)
          ctx0.lineTo(118, 118)
          ctx0.lineTo(100, 118)
          ctx0.lineTo(100, 120)
          ctx0.lineTo(20, 120)
          ctx0.lineTo(20, 118)
          ctx0.lineTo(2, 118)
          ctx0.lineTo(2, 100)
          ctx0.lineTo(0, 100)
          ctx0.lineTo(0, 20)
          ctx0.lineTo(2, 20)
          ctx0.closePath()
          ctx0.clip()
          ctx0.clearRect(0, 0, 120, 120)
          ctx0.restore()
          ctx0.restore()
          ctx0.globalCompositeOperation = 'destination-over'
          ctx0.save()
          const image = new Image()
          image.src = './assets/images/example_yrzx_1.jpg'
          image.onload = () => {
            ctx0.drawImage(image, 0, 0, 300, 300)
          }
          ctx0.restore()

          // 2. 图像的裁剪
          const canvas = document.getElementById('crop')
          const ctx = canvas.getContext('2d')
          ctx.save()
          ctx.fillStyle = 'red'
          ctx.fillRect(0, 0 , 300, 150)
          ctx.restore()
          ctx.fillRect(0, 0, 150, 150)
          ctx.fillStyle ='gray'
          ctx.arc(75, 75, 60, 0, Math.PI * 2, true)
          ctx.clip()
          ctx.clearRect(0, 0, 150, 150)
        }
    </script>
</head>
<body onload="draw()">
<h4>1. 图像的合成</h4>
<canvas id="compound"></canvas>
<h4>2. 图像的裁剪</h4>
<canvas id="crop"></canvas>
</body>
</html>
