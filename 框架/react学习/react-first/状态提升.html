<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>状态提升</title>
    <script src="js/react/development.js"></script>
    <script src="js/react/dom-development.js"></script>
    <!-- Don't use this in production: -->
    <script src="js/react/babel.min.js"></script>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
  function BoilingVerdict(props) {
    if (props.celsius >= 100) {
      return <p>水会烧开</p>
    } else {
      return <p>水不会烧开</p>
    }
  }
  const scaleNames = {
    c: 'Celsius',
    f: 'Fahrenheit'
  }
  function toCelsius(fahrenheit) {
    return (fahrenheit - 32) * 5 / 9
  }
  function toFahrenheit(celsius) {
    return celsius * 9 / 5 + 32
  }
  function tryConvert(temperature, convert) {
    const input = parseFloat(temperature)
    if (Number.isNaN(input)) {
      return ''
    }
    const output = convert(input)
    const rounded = Math.round(output * 1000) / 1000
    return rounded.toString()
  }
  class TemperatureInput extends React.Component {
    constructor(props) {
      super(props)
      this.state = {
        temperature: ''
      }
      this.handleChange = this.handleChange.bind(this)
    }
    handleChange(e) {
      this.props.onTemperatureChange(e.target.value)
    }
    render() {
      const {temperature, scale} = this.props
      return (
        <fieldset>
            <legend>Enter temperature in {scaleNames[scale]}</legend>
            <input
              value={temperature}
              onChange={this.handleChange}
            ></input>
        </fieldset>
      )
    }
  }
  class Calculator extends React.Component {
    constructor(props) {
      super(props)
      this.handleCelsiusChange = this.handleCelsiusChange.bind(this)
      this.handleFahrenheitChange = this.handleFahrenheitChange.bind(this)
      this.state = {
        temperature: '',
        scale: 'c'
      }
    }
    handleCelsiusChange(temperature) {
      this.setState({
        temperature,
        scale: 'c'
      })
    }
    handleFahrenheitChange(temperature) {
      this.setState({
        temperature,
        scale: 'f'
      })
    }

    render() {
      const {temperature, scale} = this.state
      const celsius = scale === 'c' ? temperature : tryConvert(temperature, toCelsius)
      const fahrenheit = scale === 'f' ? temperature : tryConvert(temperature, toFahrenheit)
      return (
        <div>
            <TemperatureInput
                    temperature={celsius}
                    scale="c"
                    onTemperatureChange={this.handleCelsiusChange}
            />
            <TemperatureInput
                    temperature={fahrenheit}
                    scale="f"
                    onTemperatureChange={this.handleFahrenheitChange}
            />
        </div>
      )
    }
  }
  ReactDOM.render(<Calculator />, document.getElementById('root'))
</script>
</body>
</html>
