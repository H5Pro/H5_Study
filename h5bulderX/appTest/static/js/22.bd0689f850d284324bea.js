webpackJsonp([22],{IrLP:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Xxa5"),i=s.n(a),o=s("Gu7T"),n=s.n(o),r=s("exGp"),c=s.n(r),d=(s("ULTG"),s("oobK")),l=s.n(d),u=(s("97Sy"),s("bCKv")),h=s.n(u),g=s("7+uW"),v=s("teIl"),f=s("uWBr");g.default.use(h.a),g.default.component(l.a.name,l.a);v.a;g.default.use(h.a),g.default.component(l.a.name,l.a);var p=null,m=null,k={name:"search",data:function(){return{isSearchLog:!1,searchLogList:[],searchLogPage:1,isLogEnd:!1,logLoading:!1,keywords:"",list:[],page:1,pageSize:20,isEnd:!1,loading:!1}},components:{Header:v.a},mounted:function(){this.$store.state.User&&(this.isSearchLog=!0,this.searchLogList=[],this.loadMoreSearchLog())},watch:{keywords:function(e,t){var s=this;this.list=[],this.page=1,this.isEnd=!1,this.isLogEnd=!1,this.searchLogPage=1,this.searchLogList=[],clearTimeout(p),clearTimeout(m),e?(this.isSearchLog=!1,p=setTimeout(function(){s.loadMore()},1e3)):(this.isSearchLog=!0,m=setTimeout(function(){s.loadMoreSearchLog()},1e3))}},methods:{loadMore:function(){this.isEnd||this.loading||!this.keywords||(this.loading=!0,this.getStockList())},loadMoreSearchLog:function(){this.isLogEnd||this.logLoading||this.keywords||(this.logLoading=!0,this.getSearchLogList())},getSearchLogList:function(){var e=this;return c()(i.a.mark(function t(){var s,a,o;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(s=e.$store.state.User){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,Object(f.q)(e.searchLogPage,e.pageSize,s.token);case 5:a=t.sent,e.logLoading=!1,200===a.code?(e.searchLogPage+=1,(o=(o=a.data||{}).page_data||[]).length<e.pageSize&&(e.isLogEnd=!0),e.searchLogList=[].concat(n()(e.searchLogList),n()(o))):window.EventBus.$emit("globalMessage","获取失败");case 8:case"end":return t.stop()}},t,e)}))()},getStockList:function(){var e=this;return c()(i.a.mark(function t(){var s,a,o;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!1,s=e.$store.state.User,t.next=4,Object(f.s)(e.keywords,e.page,e.pageSize,s.token);case 4:200===(a=t.sent).code?(e.page+=1,(o=(o=a.data||{}).page_data||[]).length<e.pageSize&&(e.isEnd=!0),e.list=[].concat(n()(e.list),n()(o))):window.EventBus.$emit("globalMessage","获取失败");case 6:case"end":return t.stop()}},t,e)}))()},onShow:function(e,t){t&&this.addSearchLog(e),this.$router.push({name:"Stock",params:{stock_code:e.stock_code}})},addStock:function(e){var t=this;return c()(i.a.mark(function s(){var a,o;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(1!==e.focus){s.next=2;break}return s.abrupt("return");case 2:return a=t.$store.state.User||{},s.next=5,Object(f.a)(e.stock_code,a.token);case 5:200===(o=s.sent).code&&(e.focus=1),window.EventBus.$emit("globalMessage",o.msg),t.addSearchLog(e);case 9:case"end":return s.stop()}},s,t)}))()},addSearchLog:function(e){var t=this;return c()(i.a.mark(function s(){var a,o;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(a=t.$store.state.User||{}).token){s.next=6;break}return s.next=4,Object(f.b)(e.stock_code,a.token);case 4:o=s.sent,console.log(o);case 6:case"end":return s.stop()}},s,t)}))()},delSearchLog:function(){var e=this;return c()(i.a.mark(function t(){var s,a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.$store.state.User||{},t.next=3,Object(f.c)(s.token);case 3:200===(a=t.sent).code&&(e.searchLogList=[]),window.EventBus.$emit("globalMessage",a.msg);case 6:case"end":return t.stop()}},t,e)}))()}}},L={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mfw-page with-header"},[s("Header",[s("div",{staticClass:"search-bar",attrs:{slot:"title"},slot:"title"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.keywords,expression:"keywords"}],attrs:{type:"text",placeholder:"搜索"},domProps:{value:e.keywords},on:{input:function(t){t.target.composing||(e.keywords=t.target.value)}}}),e._v(" "),s("i",{staticClass:"fa fa-search tag-search"})])]),e._v(" "),s("div",{staticClass:"mfw-page-section mt0"},[null===e.keywords||void 0===e.keywords||""===e.keywords?s("div",{staticClass:"section-content mt20"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.isSearchLog,expression:"isSearchLog"}],staticClass:"stock-history"},[s("div",{staticClass:"stock-history-head"},[e._v("搜索历史 "),s("span",{staticClass:"span-del",on:{click:function(t){return t.stopPropagation(),e.delSearchLog(t)}}},[e._v("清空")])]),e._v(" "),s("div",{staticClass:"stock-history-list"},[s("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMoreSearchLog,expression:"loadMoreSearchLog"}],staticClass:"scroll-y",attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-distance":"50","infinite-scroll-immediate-check":"false"}},[e._l(e.searchLogList,function(t,a){return s("li",{key:"st-history-"+a,staticClass:"clear-fix",on:{click:function(s){e.onShow(t)}}},[s("div",{staticClass:"left"},[s("span",[e._v(e._s(t.stock_name))]),e._v(" "),s("span",{staticClass:"span-code"},[e._v(e._s(t.stock_code))])])])}),e._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:e.isLogEnd,expression:"isLogEnd"}],staticClass:"li-isend"},[e._v("没有更多了...")])],2)])])]):s("div",{staticClass:"section-content"},[s("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],staticClass:"search-stock-ul scroll-y",attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-distance":"50","infinite-scroll-immediate-check":"false"}},[e._l(e.list,function(t,a){return s("li",{key:"search-stock-"+a,staticClass:"clear-fix",on:{click:function(s){e.onShow(t,!0)}}},[s("div",{staticClass:"left"},[s("div",[e._v(e._s(t.stock_name))]),e._v(" "),s("div",[e._v(e._s(t.stock_code))])]),e._v(" "),s("div",{staticClass:"right"},[s("div",[s("span",{class:["stock-item-price",t.dif_money>0?"text-red":t.dif_money<0?"text-green":""]},[e._v(e._s(t.now_price))])]),e._v(" "),s("div",[s("div",{class:["div-percent",,t.dif_money>0?"bg-red":t.dif_money<0?"bg-green":""]},[e._v(e._s(t.dif_rate+"%"))])]),e._v(" "),s("div",[s("button",{staticClass:"stock-item-add",attrs:{type:"button"},on:{click:function(s){s.stopPropagation(),e.addStock(t)}}},[e._v(e._s(1===t.focus?"已添加":"添加"))])])])])}),e._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:e.isEnd,expression:"isEnd"}],staticClass:"li-isend"},[e._v("没有更多了...")])],2)])])],1)},staticRenderFns:[]};var w=s("VU/8")(k,L,!1,function(e){s("rIud")},"data-v-39a246ca",null);t.default=w.exports},rIud:function(e,t){}});
//# sourceMappingURL=22.bd0689f850d284324bea.js.map